<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>市场测试模式</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body { overflow-x: hidden; }
    #sidebar { height: 100vh; }
    #canvasArea { border: 1px solid #ccc; height: 80vh; background: #f9f9f9; position: relative; }
    .node {
      position: absolute;
      padding: 10px 15px;
      background: #fff;
      border: 1px solid #333;
      border-radius: 5px;
      cursor: move;
    }
  </style>
</head>
<body>
  <!-- 顶部标题栏 -->
  <nav class="navbar navbar-dark bg-dark">
    <div class="container-fluid">
      <a class="navbar-brand" href="index.html">← 返回主页面</a>
      <span class="navbar-text text-white">市场测试模式</span>
    </div>
  </nav>

  <div class="container-fluid">
    <div class="row">
      <!-- 大侧边栏 -->
      <div id="sidebar" class="col-3 bg-light p-3">
        <h5>事件类型</h5>
        <div class="form-check">
          <input class="form-check-input" type="checkbox"> 地缘政治事件
        </div>
        <div class="form-check">
          <input class="form-check-input" type="checkbox"> 供应链风险事件
        </div>
        <div class="form-check">
          <input class="form-check-input" type="checkbox"> 管理层变动事件
        </div>
        <div class="form-check">
          <input class="form-check-input" type="checkbox"> 娱乐新闻
        </div>

        <h5 class="mt-3">影响选项</h5>
        <div class="form-check">
          <input class="form-check-input" type="checkbox"> 直接影响具体公司
        </div>
        <div class="form-check">
          <input class="form-check-input" type="checkbox"> 全局广播
        </div>

        <h5 class="mt-3">起始人群</h5>
        <select class="form-select">
          <option>散户</option>
          <option>机构</option>
          <option>海外投资者</option>
        </select>

        <h5 class="mt-3">发布时间</h5>
        <input type="datetime-local" class="form-control">

        <button class="btn btn-primary mt-3 w-100" id="addNodeBtn">生成事件节点</button>
      </div>

      <!-- 主画布 -->
      <div class="col-9 p-3">
        <h5>事件链条画布 (可拖拽)</h5>
        <div id="canvasArea"></div>
      </div>
    </div>
  </div>

  <script>
    const canvasArea = document.getElementById("canvasArea");
    const addNodeBtn = document.getElementById("addNodeBtn");
    let nodeCount = 0;

    addNodeBtn.addEventListener("click", () => {
      const node = document.createElement("div");
      node.className = "node";
      node.textContent = "事件 " + (++nodeCount);
      node.style.top = Math.random() * 300 + "px";
      node.style.left = Math.random() * 500 + "px";
      canvasArea.appendChild(node);

      let offsetX, offsetY, dragging = false;
      node.addEventListener("mousedown", (e) => {
        dragging = true;
        offsetX = e.offsetX;
        offsetY = e.offsetY;
      });
      document.addEventListener("mousemove", (e) => {
        if (dragging) {
          node.style.left = (e.pageX - canvasArea.offsetLeft - offsetX) + "px";
          node.style.top = (e.pageY - canvasArea.offsetTop - offsetY) + "px";
        }
      });
      document.addEventListener("mouseup", () => dragging = false);
    });
  </script>
</body>
</html>
